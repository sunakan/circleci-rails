version: 2.1
setup: true

jobs:
  container-cimg-base:
    docker:
      - image: cimg/base:current
    resource_class: small
    steps:
      - run:
          name: hello
          command: |
            #!/usr/bin/env sh
            echo "pwd=$(pwd)"
            ls -al
            echo 'Hello: cimg/base:current'
            uname -a
            whoami
            echo '---makeの有無'
            make -v
            echo '---nodeの有無'
            node -v
            echo '---rubyの有無'
            ruby -v
            echo '---aws cliの有無'
            aws -v
            echo '---curlの有無'
            curl -v
            echo '---jqの有無'
            jq -v
            echo '---yqの有無'
            yq -v
            echo '---circleciの有無'
            circleci -h
            echo 'DONE'

  container-alpine:
    docker:
      - image: alpine:latest
    resource_class: small
    steps:
      - run:
          name: hello
          command: |
            #!/usr/bin/env sh
            echo "pwd=$(pwd)"
            ls -al
            echo 'Hello: alpine:latest'
            uname -a
            whoami
            echo '---makeの有無'
            make -v
            echo '---nodeの有無'
            node -v
            echo '---rubyの有無'
            ruby -v
            echo '---aws cliの有無'
            aws -v
            echo '---curlの有無'
            curl -v
            echo '---jqの有無'
            jq -v
            echo '---yqの有無'
            yq -v
            echo '---circleciの有無'
            circleci -h
            echo 'DONE'

  container-my-img:
    docker:
      - image: ghcr.io/sunakan/circleci-rails-ci:latest
    resource_class: arm.medium
    steps:
      - run:
          name: hello
          command: |
            #!/usr/bin/env sh
            echo "pwd=$(pwd)"
            ls -al
            echo 'Hello: ghcr.io/sunakan/circleci-rails-ci:latest'
            uname -a
            whoami
            echo '---makeの有無'
            make -v
            echo '---nodeの有無'
            node -v
            echo '---rubyの有無'
            ruby -v
            echo '---aws cliの有無'
            aws -v
            echo '---curlの有無'
            curl -v
            echo '---jqの有無'
            jq -v
            echo '---yqの有無'
            yq -v
            echo '---circleciの有無'
            circleci -h
            echo 'DONE'

  machine-x86:
    machine:
      image: ubuntu-2404:current
    resource_class: medium
    steps:
      - checkout
      - run:
          name: hello
          command: |
            #!/usr/bin/env sh
            echo "pwd=$(pwd)"
            ls -al
            echo 'Hello: ubuntu-2404:current'
            uname -a
            whoami
            echo '---makeの有無'
            make -v
            echo '---nodeの有無'
            node -v
            echo '---rubyの有無'
            ruby -v
            echo '---aws cliの有無'
            aws -v
            echo '---curlの有無'
            curl -v
            echo '---jqの有無'
            jq -v
            echo '---yqの有無'
            yq -v
            echo '---circleciの有無'
            circleci -h
            echo 'DONE'

  machine-arm:
    machine:
      image: ubuntu-2404:current
    resource_class: arm.medium
    steps:
      - run:
          name: hello
          command: |
            #!/usr/bin/env sh
            echo "pwd=$(pwd)"
            ls -al
            echo 'Hello: ubuntu-2404:current'
            uname -a
            whoami
            echo '---makeの有無'
            make -v
            echo '---nodeの有無'
            node -v
            echo '---rubyの有無'
            ruby -v
            echo '---aws cliの有無'
            aws -v
            echo '---curlの有無'
            curl -v
            echo '---jqの有無'
            jq -v
            echo '---yqの有無'
            yq -v
            echo '---circleciの有無'
            circleci -h
            echo 'DONE'

workflows:
  my-workflow:
    jobs:
      - container-cimg-base
      - container-alpine
      - container-my-img
      - machine-01
      - machine-02
